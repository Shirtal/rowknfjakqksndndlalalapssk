(()=>{"use strict";function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}console.log("The script is currently working!");var r="",t="",n="Q0.";function o(e,r){var t=document.body.innerText,n=t.indexOf(e);if(r){var o=n+e.length,i=t.indexOf(r,o);return t.substring(o,i).trim()}return t.substring(n).trim()}new MutationObserver((function(i){var a,c,l,s=document.querySelector('[class^="read-content"]'),u=document.querySelector('[class="PanelPaperbackQuestionContainer"]');if(s){var f=o("Start reading here","Stop reading here");r!==f&&(r=f,console.log(f))}if(u){var d=o("Q"),m=function(r){if(Array.isArray(r))return e(r)}(l=d.matchAll(/Q\d+\./g))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(l)||function(r,t){if(r){if("string"==typeof r)return e(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),g=d;if(m.length>1&&(g=d.replace(/Q\d+\.[\s\S]*?(?=Q\d+\.)/,"")),(d=g.trim())!==t&&!d.startsWith(n)){if(n=d.slice(0,3),t=d,console.log(d),!r)return void console.log("No extract to copy!");(a=d,c=r,new Promise((function(e){chrome.runtime.sendMessage({action:"generate",prompt:a,extract:c},(function(r){e(r.result)}))}))).then((function(e){console.log("Generated text:",e),alert(e)}))}}})).observe(document.body,{childList:!0,subtree:!0})})();